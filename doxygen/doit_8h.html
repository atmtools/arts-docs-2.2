<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: doit.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.2.66</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('doit_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">doit.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Radiative transfer in cloudbox.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="agenda__class_8h_source.html">agenda_class.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matpackVI_8h_source.html">matpackVI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ppath_8h_source.html">ppath.h</a>&quot;</code><br />
</div>
<p><a href="doit_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7d9973a78d04c8dfa9010153ddec88eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a7d9973a78d04c8dfa9010153ddec88eb">rte_step_doit</a> (<a class="el" href="classVectorView.html">VectorView</a> stokes_vec, <a class="el" href="classMatrixView.html">MatrixView</a> trans_mat, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> ext_mat_av, <a class="el" href="classConstVectorView.html">ConstVectorView</a> abs_vec_av, <a class="el" href="classConstVectorView.html">ConstVectorView</a> sca_vec_av, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;lstep, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;rtp_planck_value, const bool &amp;trans_is_precalc=false)</td></tr>
<tr class="memdesc:a7d9973a78d04c8dfa9010153ddec88eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">rte_step_doit  <a href="doit_8h.html#a7d9973a78d04c8dfa9010153ddec88eb">More...</a><br /></td></tr>
<tr class="separator:a7d9973a78d04c8dfa9010153ddec88eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71867d5dc13f93c045aa6d2a8ceafcfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a71867d5dc13f93c045aa6d2a8ceafcfc">cloud_fieldsCalc</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor5View.html">Tensor5View</a> ext_mat_field, <a class="el" href="classTensor4View.html">Tensor4View</a> abs_vec_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;spt_calc_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;opt_prop_part_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_aa_index, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> pnd_field, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a71867d5dc13f93c045aa6d2a8ceafcfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">cloud_fieldsCalc  <a href="doit_8h.html#a71867d5dc13f93c045aa6d2a8ceafcfc">More...</a><br /></td></tr>
<tr class="separator:a71867d5dc13f93c045aa6d2a8ceafcfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b28f98261cbe5a71bb20efd463a1574"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a6b28f98261cbe5a71bb20efd463a1574">cloud_ppath_update1D</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> i_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> scat_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;ppath_step_agenda, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lraytrace, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> refellipsoid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, <a class="el" href="classConstTensor5View.html">ConstTensor5View</a> ext_mat_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> abs_vec_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;surface_rtprop_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_interp, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a6b28f98261cbe5a71bb20efd463a1574"><td class="mdescLeft">&#160;</td><td class="mdescRight">cloud_ppath_update1D  <a href="doit_8h.html#a6b28f98261cbe5a71bb20efd463a1574">More...</a><br /></td></tr>
<tr class="separator:a6b28f98261cbe5a71bb20efd463a1574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ecbb07170a2c727d62bc10abc46fa5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a75ecbb07170a2c727d62bc10abc46fa5">cloud_ppath_update1D_noseq</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> doit_i_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> doit_i_field_old, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> doit_scat_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;ppath_step_agenda, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lraytrace, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> refellipsoid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, <a class="el" href="classConstTensor5View.html">ConstTensor5View</a> ext_mat_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> abs_vec_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;surface_rtprop_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_interp, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a75ecbb07170a2c727d62bc10abc46fa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">cloud_ppath_update1D_noseq  <a href="doit_8h.html#a75ecbb07170a2c727d62bc10abc46fa5">More...</a><br /></td></tr>
<tr class="separator:a75ecbb07170a2c727d62bc10abc46fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57d38cfe0ef5d51fca2b58d9d4b26e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#ab57d38cfe0ef5d51fca2b58d9d4b26e1">cloud_ppath_update1D_planeparallel</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> i_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> scat_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, <a class="el" href="classConstTensor5View.html">ConstTensor5View</a> ext_mat_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> abs_vec_field, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:ab57d38cfe0ef5d51fca2b58d9d4b26e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Radiative transfer calculation inside cloudbox for planeparallel case.  <a href="doit_8h.html#ab57d38cfe0ef5d51fca2b58d9d4b26e1">More...</a><br /></td></tr>
<tr class="separator:ab57d38cfe0ef5d51fca2b58d9d4b26e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1468fb73e53e27a674ecdc0ce63e90ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a1468fb73e53e27a674ecdc0ce63e90ec">cloud_ppath_update3D</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> doit_i_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lat_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lon_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_aa_index, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_aa_grid, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> doit_scat_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;ppath_step_agenda, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lraytrace, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lat_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lon_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> refellipsoid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, <a class="el" href="classConstTensor5View.html">ConstTensor5View</a> ext_mat_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> abs_vec_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a1468fb73e53e27a674ecdc0ce63e90ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Radiative transfer calculation along a path inside the cloudbox (3D).  <a href="doit_8h.html#a1468fb73e53e27a674ecdc0ce63e90ec">More...</a><br /></td></tr>
<tr class="separator:a1468fb73e53e27a674ecdc0ce63e90ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec040da392ce33ff354c32cb319ab814"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#aec040da392ce33ff354c32cb319ab814">cloud_RT_no_background</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> doit_i_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath_step, <a class="el" href="classConstVectorView.html">ConstVectorView</a> t_int, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> vmr_list_int, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> ext_mat_int, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> abs_vec_int, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> sca_vec_int, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> doit_i_field_int, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_int, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lat_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lon_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_aa_index, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:aec040da392ce33ff354c32cb319ab814"><td class="mdescLeft">&#160;</td><td class="mdescRight">cloud_RT_no_background  <a href="doit_8h.html#aec040da392ce33ff354c32cb319ab814">More...</a><br /></td></tr>
<tr class="separator:aec040da392ce33ff354c32cb319ab814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b9325718a0cd28107a20f4db06e811"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a54b9325718a0cd28107a20f4db06e811">cloud_RT_surface</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6View.html">Tensor6View</a> doit_i_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;surface_rtprop_agenda, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;f_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;stokes_dim, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath_step, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_index)</td></tr>
<tr class="memdesc:a54b9325718a0cd28107a20f4db06e811"><td class="mdescLeft">&#160;</td><td class="mdescRight">cloud_RT_surface  <a href="doit_8h.html#a54b9325718a0cd28107a20f4db06e811">More...</a><br /></td></tr>
<tr class="separator:a54b9325718a0cd28107a20f4db06e811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57b758e8a3b1c41bb181441d5704a2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#ad57b758e8a3b1c41bb181441d5704a2e">interp_cloud_coeff1D</a> (<a class="el" href="classTensor3View.html">Tensor3View</a> ext_mat_int, <a class="el" href="classMatrixView.html">MatrixView</a> abs_vec_int, <a class="el" href="classMatrixView.html">MatrixView</a> sca_vec_int, <a class="el" href="classMatrixView.html">MatrixView</a> doit_i_field_int, <a class="el" href="classVectorView.html">VectorView</a> t_int, <a class="el" href="classMatrixView.html">MatrixView</a> vmr_list_int, <a class="el" href="classVectorView.html">VectorView</a> p_int, <a class="el" href="classConstTensor5View.html">ConstTensor5View</a> ext_mat_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> abs_vec_field, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> doit_scat_field, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> doit_i_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath_step, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, <a class="el" href="classConstVectorView.html">ConstVectorView</a> scat_za_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_interp, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:ad57b758e8a3b1c41bb181441d5704a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">interp_cloud_coeff1D  <a href="doit_8h.html#ad57b758e8a3b1c41bb181441d5704a2e">More...</a><br /></td></tr>
<tr class="separator:ad57b758e8a3b1c41bb181441d5704a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1255133591972aa0e291e91bdac2340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#af1255133591972aa0e291e91bdac2340">za_gridOpt</a> (<a class="el" href="classVector.html">Vector</a> &amp;za_grid_opt, <a class="el" href="classMatrix.html">Matrix</a> &amp;i_field_opt, <a class="el" href="classConstVectorView.html">ConstVectorView</a> za_grid_fine, <a class="el" href="classConstTensor6View.html">ConstTensor6View</a> i_field, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;acc, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_za_interp)</td></tr>
<tr class="separator:af1255133591972aa0e291e91bdac2340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a658b8f450a78e456af8223afa97fb75a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#a658b8f450a78e456af8223afa97fb75a">iy_interp_cloudbox_field</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;iy, const <a class="el" href="classTensor7.html">Tensor7</a> &amp;scat_i_p, const <a class="el" href="classTensor7.html">Tensor7</a> &amp;scat_i_lat, const <a class="el" href="classTensor7.html">Tensor7</a> &amp;scat_i_lon, const <a class="el" href="classTensor4.html">Tensor4</a> &amp;doit_i_field1D_spectrum, const <a class="el" href="structGridPos.html">GridPos</a> &amp;rte_gp_p, const <a class="el" href="structGridPos.html">GridPos</a> &amp;rte_gp_lat, const <a class="el" href="structGridPos.html">GridPos</a> &amp;rte_gp_lon, const <a class="el" href="classVector.html">Vector</a> &amp;rte_los, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;stokes_dim, const <a class="el" href="classVector.html">Vector</a> &amp;scat_za_grid, const <a class="el" href="classVector.html">Vector</a> &amp;scat_aa_grid, const <a class="el" href="classVector.html">Vector</a> &amp;f_grid, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;interpmeth, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;rigorous, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;maxratio, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a658b8f450a78e456af8223afa97fb75a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolation of cloud box intensity field.  <a href="doit_8h.html#a658b8f450a78e456af8223afa97fb75a">More...</a><br /></td></tr>
<tr class="separator:a658b8f450a78e456af8223afa97fb75a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8612c3bfeeea4236e15240b9049cee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="doit_8h.html#aab8612c3bfeeea4236e15240b9049cee">doit_scat_fieldNormalize</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor6.html">Tensor6</a> &amp;doit_scat_field, const <a class="el" href="classTensor6.html">Tensor6</a> &amp;doit_i_field, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, const <a class="el" href="classAgenda.html">Agenda</a> &amp;spt_calc_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="classVector.html">Vector</a> &amp;scat_za_grid, const <a class="el" href="classVector.html">Vector</a> &amp;scat_aa_grid, const <a class="el" href="classTensor4.html">Tensor4</a> &amp;pnd_field, const <a class="el" href="classAgenda.html">Agenda</a> &amp;opt_prop_part_agenda, const <a class="el" href="classTensor3.html">Tensor3</a> &amp;t_field, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;norm_error_threshold, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;norm_debug, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:aab8612c3bfeeea4236e15240b9049cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalization of scattered field.  <a href="doit_8h.html#aab8612c3bfeeea4236e15240b9049cee">More...</a><br /></td></tr>
<tr class="separator:aab8612c3bfeeea4236e15240b9049cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Radiative transfer in cloudbox. </p>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde <a href="#" onclick="location.href='mai'+'lto:'+'cla'+'ud'+'ia.'+'em'+'de@'+'dl'+'r.d'+'e'; return false;">claud<span style="display: none;">.nosp@m.</span>ia.e<span style="display: none;">.nosp@m.</span>mde@d<span style="display: none;">.nosp@m.</span>lr.d<span style="display: none;">.nosp@m.</span>e</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003-06-03</dd></dl>
<p>This file contains functions related to the radiative transfer in the cloudbox using the DOIT method. </p>

<p class="definition">Definition in file <a class="el" href="doit_8h_source.html">doit.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a71867d5dc13f93c045aa6d2a8ceafcfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71867d5dc13f93c045aa6d2a8ceafcfc">&#9670;&nbsp;</a></span>cloud_fieldsCalc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_fieldsCalc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor5View.html">Tensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor4View.html">Tensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>spt_calc_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>opt_prop_part_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_aa_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>pnd_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cloud_fieldsCalc </p>
<p>Calculate ext_mat, abs_vec for all points inside the cloudbox for one propagation direction. sca_vec can be obtained from the workspace variable doit_scat_field. As we need the average for each layer, it makes sense to calculte the coefficients once and store them in an array instead of calculating at each point the coefficient of the point above and the point below.</p>
<p>Output </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ws</td><td>Current <a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> </td></tr>
    <tr><td class="paramname">ext_mat_field</td><td>extinction matrix field </td></tr>
    <tr><td class="paramname">abs_vec_field</td><td>absorption vector field Input </td></tr>
    <tr><td class="paramname">spt_calc_agenda</td><td><a class="el" href="classAgenda.html" title="The Agenda class.">Agenda</a> for calculation of single scattering properties </td></tr>
    <tr><td class="paramname">opt_prop_part_agenda</td><td><a class="el" href="classAgenda.html" title="The Agenda class.">Agenda</a> for summing over all hydrometeor species </td></tr>
    <tr><td class="paramname">scat_za_index</td><td>Indices for </td></tr>
    <tr><td class="paramname">scat_aa_index</td><td>propagation direction </td></tr>
    <tr><td class="paramname">cloudbox_limits</td><td>Cloudbox limits. </td></tr>
    <tr><td class="paramname">t_field</td><td>Temperature field </td></tr>
    <tr><td class="paramname">pnd_field</td><td>Particle number density field.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-06-03 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l00257">257</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackIV_8cc_source.html#l00081">ConstTensor4View::ncols()</a>, <a class="el" href="matpackV_8cc_source.html#l00059">ConstTensor5View::ncols()</a>, <a class="el" href="array_8h_source.html#l00176">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackV_8cc_source.html#l00053">ConstTensor5View::nrows()</a>, <a class="el" href="auto__md_8cc_source.html#l14459">opt_prop_part_agendaExecute()</a>, and <a class="el" href="auto__md_8cc_source.html#l14960">spt_calc_agendaExecute()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l00608">doit_i_fieldUpdate1D()</a>, <a class="el" href="m__doit_8cc_source.html#l00772">doit_i_fieldUpdateSeq1D()</a>, <a class="el" href="m__doit_8cc_source.html#l01360">doit_i_fieldUpdateSeq1DPP()</a>, <a class="el" href="m__doit_8cc_source.html#l01064">doit_i_fieldUpdateSeq3D()</a>, and <a class="el" href="doit_8cc_source.html#l02521">doit_scat_fieldNormalize()</a>.</p>

</div>
</div>
<a id="a6b28f98261cbe5a71bb20efd463a1574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b28f98261cbe5a71bb20efd463a1574">&#9670;&nbsp;</a></span>cloud_ppath_update1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_ppath_update1D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lraytrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>refellipsoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor5View.html">ConstTensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>surface_rtprop_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_interp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cloud_ppath_update1D </p>
<p>This function calculates the radiation field along a propagation path step for specified zenith direction and pressure level. This function is used in the sequential update and called inside a loop over the pressure grid. In the function the intersection point of the propagation path with the next layer is calculated and all atmospheric properties are interpolated an the intersection point. Then a radiative transfer step is performed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>Current <a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> WS Output: </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">doit_i_field</td><td>Updated radiation field inside the cloudbox. WS Input: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_index</td><td>// Pressure index </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_index</td><td>// Index for proagation direction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cloudbox_limits</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">doit_scat_field</td><td>Scattered field. Calculate scalar gas absorption: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">propmat_clearsky_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vmr_field</td><td>Propagation path calculation: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ppath_step_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">z_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">refellipsoid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">z_surface</td><td>Calculate thermal emission: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">t_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_index</td><td>Optical properties of particles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ext_mat_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">abs_vec_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">surface_rtprop_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_interp</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003-06-04 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l00416">416</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l20458">abs</a>, <a class="el" href="doit_8cc_source.html#l01016">cloud_RT_no_background()</a>, <a class="el" href="doit_8cc_source.html#l01175">cloud_RT_surface()</a>, <a class="el" href="ppath_8h_source.html#l00076">Ppath::gp_p</a>, <a class="el" href="doit_8cc_source.html#l01253">interp_cloud_coeff1D()</a>, <a class="el" href="ppath_8h_source.html#l00068">Ppath::los</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>, <a class="el" href="ppath_8h_source.html#l00067">Ppath::pos</a>, <a class="el" href="ppath_8cc_source.html#l01726">ppath_init_structure()</a>, <a class="el" href="auto__md_8cc_source.html#l14720">ppath_step_agendaExecute()</a>, <a class="el" href="ppath_8cc_source.html#l01835">ppath_what_background()</a>, and <a class="el" href="ppath_8h_source.html#l00069">Ppath::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l00772">doit_i_fieldUpdateSeq1D()</a>.</p>

</div>
</div>
<a id="a75ecbb07170a2c727d62bc10abc46fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ecbb07170a2c727d62bc10abc46fa5">&#9670;&nbsp;</a></span>cloud_ppath_update1D_noseq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_ppath_update1D_noseq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lraytrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>refellipsoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor5View.html">ConstTensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>surface_rtprop_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_interp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cloud_ppath_update1D_noseq </p>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l00556">556</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l20458">abs</a>, <a class="el" href="doit_8cc_source.html#l01016">cloud_RT_no_background()</a>, <a class="el" href="doit_8cc_source.html#l01175">cloud_RT_surface()</a>, <a class="el" href="ppath_8h_source.html#l00076">Ppath::gp_p</a>, <a class="el" href="doit_8cc_source.html#l01253">interp_cloud_coeff1D()</a>, <a class="el" href="ppath_8h_source.html#l00068">Ppath::los</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>, <a class="el" href="ppath_8h_source.html#l00067">Ppath::pos</a>, <a class="el" href="ppath_8cc_source.html#l01726">ppath_init_structure()</a>, <a class="el" href="auto__md_8cc_source.html#l14720">ppath_step_agendaExecute()</a>, <a class="el" href="ppath_8cc_source.html#l01835">ppath_what_background()</a>, and <a class="el" href="ppath_8h_source.html#l00069">Ppath::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l00608">doit_i_fieldUpdate1D()</a>.</p>

</div>
</div>
<a id="ab57d38cfe0ef5d51fca2b58d9d4b26e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab57d38cfe0ef5d51fca2b58d9d4b26e1">&#9670;&nbsp;</a></span>cloud_ppath_update1D_planeparallel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_ppath_update1D_planeparallel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor5View.html">ConstTensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Radiative transfer calculation inside cloudbox for planeparallel case. </p>
<p>This function calculates the radiation field along a line of sight. This function is used for the sequential update of the radiation field and called inside a loop over the pressure grid.</p>
<p>The function gets all the atmospheric points on the pressure grid. Then a radiative transfer step is performed using the stokes vector as output and input. The inermediate Stokes vectors are stored in the WSV doit_i_field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>Current <a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> WS Output: </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">doit_i_field</td><td>Updated radiation field inside the cloudbox. Variables used in opt_prop_xxx_agenda: WS Input: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_index</td><td>// Pressure index </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_index</td><td>// Index for proagation direction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cloudbox_limits</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">doit_scat_field</td><td>Scattered field. Calculate scalar gas absorption: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">propmat_clearsky_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vmr_field</td><td>Propagation path calculation: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ppath_step_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">z_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">refellipsoid</td><td>Calculate thermal emission: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">t_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_index</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ext_mat_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">abs_vec_field</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Sreerekha Ravi </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003-11-17 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l01446">1446</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l20458">abs</a>, <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="logic_8cc_source.html#l00377">is_singular()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="optproperties_8cc_source.html#l00987">opt_prop_sum_propmat_clearsky()</a>, <a class="el" href="doit_8cc.html#a9d0fb1720e9df57970c08cc4e3ee0bc0">PI</a>, <a class="el" href="physics__funcs_8cc_source.html#l00261">planck()</a>, <a class="el" href="auto__md_8cc_source.html#l13039">propmat_clearsky_agendaExecute()</a>, and <a class="el" href="doit_8cc_source.html#l00108">rte_step_doit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l01360">doit_i_fieldUpdateSeq1DPP()</a>.</p>

</div>
</div>
<a id="a1468fb73e53e27a674ecdc0ce63e90ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1468fb73e53e27a674ecdc0ce63e90ec">&#9670;&nbsp;</a></span>cloud_ppath_update3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_ppath_update3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_aa_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_aa_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lraytrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lon_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>refellipsoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor5View.html">ConstTensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Radiative transfer calculation along a path inside the cloudbox (3D). </p>
<p>This function calculates the radiation field along a propagation path step for a specified zenith direction. This function is used for the sequential update if the radiation field and called inside a loop over the pressure grid. In the function the intersection point of the propagation path with the next layer is calculated and all atmospheric properties are interpolated an the intersection point. Then a radiative transfer step is performed using the stokes vector as output and input. The inermediate Stokes vectors are stored in the WSV doit_i_field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>Current workspace WS Output: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">doit_i_field</td><td>Updated radiation field inside the cloudbox. WS Input: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_index</td><td>// Pressure index </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lat_index</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lon_index</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_index</td><td>// Index for proagation direction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_aa_index</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_za_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">scat_aa_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cloudbox_limits</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">doit_scat_field</td><td>Scattered field. Calculate scalar gas absorption: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">propmat_clearsky_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vmr_field</td><td>Propagation path calculation: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ppath_step_agenda</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lat_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lon_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">z_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">refellipsoid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">z_surface</td><td>Calculate thermal emission: </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">t_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_grid</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f_index</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ext_mat_field</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">abs_vec_field</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003-06-04 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l00738">738</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="doit_8cc_source.html#l01016">cloud_RT_no_background()</a>, <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="ppath_8h_source.html#l00077">Ppath::gp_lat</a>, <a class="el" href="ppath_8h_source.html#l00078">Ppath::gp_lon</a>, <a class="el" href="ppath_8h_source.html#l00076">Ppath::gp_p</a>, <a class="el" href="interpolation_8cc_source.html#l00167">gridpos()</a>, <a class="el" href="interpolation_8cc_source.html#l00643">gridpos_upperend_check()</a>, <a class="el" href="interpolation_8cc_source.html#l01046">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00802">interpweights()</a>, <a class="el" href="cloudbox_8cc_source.html#l00892">is_inside_cloudbox()</a>, <a class="el" href="special__interp_8cc_source.html#l00561">itw2p()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="ppath_8h_source.html#l00068">Ppath::los</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>, <a class="el" href="ppath_8h_source.html#l00067">Ppath::pos</a>, <a class="el" href="ppath_8cc_source.html#l01726">ppath_init_structure()</a>, <a class="el" href="auto__md_8cc_source.html#l14720">ppath_step_agendaExecute()</a>, <a class="el" href="ppath_8h_source.html#l00069">Ppath::r</a>, and <a class="el" href="geodetic_8cc_source.html#l01199">refell2r()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l01064">doit_i_fieldUpdateSeq3D()</a>.</p>

</div>
</div>
<a id="aec040da392ce33ff354c32cb319ab814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec040da392ce33ff354c32cb319ab814">&#9670;&nbsp;</a></span>cloud_RT_no_background()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_RT_no_background </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>t_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>vmr_list_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>abs_vec_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>sca_vec_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>doit_i_field_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_aa_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cloud_RT_no_background </p>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l01016">1016</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="logic_8cc_source.html#l00377">is_singular()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="ppath_8h_source.html#l00070">Ppath::lstep</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="array_8h_source.html#l00176">Array&lt; base &gt;::nelem()</a>, <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>, <a class="el" href="matpackI_8cc_source.html#l00832">ConstMatrixView::nrows()</a>, <a class="el" href="optproperties_8cc_source.html#l00987">opt_prop_sum_propmat_clearsky()</a>, <a class="el" href="physics__funcs_8cc_source.html#l00261">planck()</a>, <a class="el" href="auto__md_8cc_source.html#l13039">propmat_clearsky_agendaExecute()</a>, <a class="el" href="doit_8cc_source.html#l00108">rte_step_doit()</a>, and <a class="el" href="matpackI_8cc_source.html#l00813">swap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="doit_8cc_source.html#l00416">cloud_ppath_update1D()</a>, <a class="el" href="doit_8cc_source.html#l00556">cloud_ppath_update1D_noseq()</a>, and <a class="el" href="doit_8cc_source.html#l00738">cloud_ppath_update3D()</a>.</p>

</div>
</div>
<a id="a54b9325718a0cd28107a20f4db06e811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b9325718a0cd28107a20f4db06e811">&#9670;&nbsp;</a></span>cloud_RT_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloud_RT_surface </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6View.html">Tensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>surface_rtprop_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>f_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>stokes_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cloud_RT_surface </p>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l01175">1175</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="check__input_8cc_source.html#l00768">chk_not_empty()</a>, <a class="el" href="ppath_8h_source.html#l00060">Ppath::dim</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="ppath_8h_source.html#l00068">Ppath::los</a>, <a class="el" href="matpackI_8cc_source.html#l01648">mult()</a>, <a class="el" href="matpackI_8cc_source.html#l00838">ConstMatrixView::ncols()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>, <a class="el" href="matpackI_8cc_source.html#l00832">ConstMatrixView::nrows()</a>, <a class="el" href="ppath_8h_source.html#l00067">Ppath::pos</a>, <a class="el" href="matpackI_8cc_source.html#l00798">Vector::resize()</a>, and <a class="el" href="auto__md_8cc_source.html#l15046">surface_rtprop_agendaExecute()</a>.</p>

<p class="reference">Referenced by <a class="el" href="doit_8cc_source.html#l00416">cloud_ppath_update1D()</a>, and <a class="el" href="doit_8cc_source.html#l00556">cloud_ppath_update1D_noseq()</a>.</p>

</div>
</div>
<a id="aab8612c3bfeeea4236e15240b9049cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab8612c3bfeeea4236e15240b9049cee">&#9670;&nbsp;</a></span>doit_scat_fieldNormalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doit_scat_fieldNormalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor6.html">Tensor6</a> &amp;&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor6.html">Tensor6</a> &amp;&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>spt_calc_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_aa_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor4.html">Tensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>opt_prop_part_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_error_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_debug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalization of scattered field. </p>
<p>Calculate the scattered extinction field and apply the derived correction factor to doit_scat_field.</p>
<p>Only 1D is supported.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>Current workspace </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">doit_scat_field</td><td>Scattered field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloudbox_limits</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spt_calc_agenda</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmopshere_dim</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_za_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_aa_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_field</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opt_prop_part_agenda</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t_field</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">norm_error_threshold</td><td>Normalization error threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td><a class="el" href="classVerbosity.html">Verbosity</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Oliver Lemke </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2013-01-17 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l02521">2521</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l20458">abs</a>, <a class="el" href="math__funcs_8cc_source.html#l00327">AngIntegrate_trapezoid()</a>, <a class="el" href="doit_8cc_source.html#l00257">cloud_fieldsCalc()</a>, <a class="el" href="messages_8h_source.html#l00211">CREATE_OUT0</a>, <a class="el" href="messages_8h_source.html#l00213">CREATE_OUT2</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="matpackVI_8cc_source.html#l00044">ConstTensor6View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, <a class="el" href="matpackVI_8cc_source.html#l00050">ConstTensor6View::npages()</a>, <a class="el" href="matpackVI_8cc_source.html#l00056">ConstTensor6View::nrows()</a>, <a class="el" href="matpackVI_8cc_source.html#l00038">ConstTensor6View::nshelves()</a>, and <a class="el" href="matpackVI_8cc_source.html#l00032">ConstTensor6View::nvitrines()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l00772">doit_i_fieldUpdateSeq1D()</a>.</p>

</div>
</div>
<a id="ad57b758e8a3b1c41bb181441d5704a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad57b758e8a3b1c41bb181441d5704a2e">&#9670;&nbsp;</a></span>interp_cloud_coeff1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void interp_cloud_coeff1D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>abs_vec_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>sca_vec_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>doit_i_field_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>t_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>vmr_list_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>p_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor5View.html">ConstTensor5View</a>&#160;</td>
          <td class="paramname"><em>ext_mat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>abs_vec_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_scat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_interp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>interp_cloud_coeff1D </p>
<p>Interpolate all inputs of the VRTE on a propagation path step. Used in the WSM cloud_ppath_update1D.</p>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003-06-06 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l01253">1253</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="ppath_8h_source.html#l00076">Ppath::gp_p</a>, <a class="el" href="interpolation_8cc_source.html#l00167">gridpos()</a>, <a class="el" href="interpolation_8cc_source.html#l00643">gridpos_upperend_check()</a>, <a class="el" href="interpolation_8cc_source.html#l01046">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l02955">interp_poly()</a>, <a class="el" href="interpolation_8cc_source.html#l00802">interpweights()</a>, <a class="el" href="special__interp_8cc_source.html#l00561">itw2p()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="ppath_8h_source.html#l00068">Ppath::los</a>, <a class="el" href="matpackIV_8cc_source.html#l00063">ConstTensor4View::nbooks()</a>, <a class="el" href="matpackVI_8cc_source.html#l00062">ConstTensor6View::ncols()</a>, <a class="el" href="array_8h_source.html#l00176">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, and <a class="el" href="ppath_8h_source.html#l00061">Ppath::np</a>.</p>

<p class="reference">Referenced by <a class="el" href="doit_8cc_source.html#l00416">cloud_ppath_update1D()</a>, and <a class="el" href="doit_8cc_source.html#l00556">cloud_ppath_update1D_noseq()</a>.</p>

</div>
</div>
<a id="a658b8f450a78e456af8223afa97fb75a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a658b8f450a78e456af8223afa97fb75a">&#9670;&nbsp;</a></span>iy_interp_cloudbox_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iy_interp_cloudbox_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor7.html">Tensor7</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_i_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor7.html">Tensor7</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_i_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor7.html">Tensor7</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_i_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor4.html">Tensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>doit_i_field1D_spectrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structGridPos.html">GridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_gp_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structGridPos.html">GridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_gp_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structGridPos.html">GridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_gp_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>stokes_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_aa_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>interpmeth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>rigorous</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>maxratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolation of cloud box intensity field. </p>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l02094">2094</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="messages_8h_source.html#l00214">CREATE_OUT3</a>, <a class="el" href="debug_8h_source.html#l00037">DEBUG_ONLY</a>, <a class="el" href="interpolation_8cc_source.html#l00539">fractional_gp()</a>, <a class="el" href="interpolation_8cc_source.html#l00167">gridpos()</a>, <a class="el" href="interpolation_8cc_source.html#l00643">gridpos_upperend_check()</a>, <a class="el" href="interpolation_8h_source.html#l00075">GridPos::idx</a>, <a class="el" href="interpolation_8cc_source.html#l01046">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l02955">interp_poly()</a>, <a class="el" href="interpolation_8cc_source.html#l00802">interpweights()</a>, <a class="el" href="interpolation_8cc_source.html#l00702">is_gridpos_at_index_i()</a>, <a class="el" href="logic_8cc_source.html#l00091">is_size()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="matpackVII_8cc_source.html#l00050">ConstTensor7View::nbooks()</a>, <a class="el" href="array_8h_source.html#l00176">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, <a class="el" href="matpackVII_8cc_source.html#l00032">ConstTensor7View::nlibraries()</a>, <a class="el" href="matpackVII_8cc_source.html#l00044">ConstTensor7View::nshelves()</a>, <a class="el" href="matpackVII_8cc_source.html#l00038">ConstTensor7View::nvitrines()</a>, and <a class="el" href="matpackI_8cc_source.html#l01580">Matrix::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l03221">iyInterpCloudboxField()</a>, and <a class="el" href="m__doit_8cc_source.html#l03266">iyInterpPolyCloudboxField()</a>.</p>

</div>
</div>
<a id="a7d9973a78d04c8dfa9010153ddec88eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d9973a78d04c8dfa9010153ddec88eb">&#9670;&nbsp;</a></span>rte_step_doit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rte_step_doit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>stokes_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>trans_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>ext_mat_av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>abs_vec_av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>sca_vec_av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>lstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>rtp_planck_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>trans_is_precalc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rte_step_doit </p>
<p>Solves monochromatic VRTE for an atmospheric slab with constant conditions.</p>
<p>The function can be used for cloudbox calculations.</p>
<p>The function is best explained by considering a homogenous layer. That is, the physical conditions inside the layer are constant. In reality they are not constant, so in practical all coefficients have to be averaged before calling this function. Total extinction and absorption inside the layer are described by ext_mat_av* and <em>abs_vec_av</em> respectively, the blackbdody radiation of the layer is given by <em>rte_planck_value</em> and the propagation path length through the layer is <em>lstep</em>.</p>
<p>There is an additional scattering source term in the VRTE, the scattering integral term. For this function a constant scattering term is assumed. The radiative transfer step is only a part the iterative solution of the scattering problem, for more information consider AUG. In the clearsky case this variable has to be set to 0.</p>
<p>When calling the function, the vector <em>stokes_vec</em> shall contain the Stokes vector for the incoming radiation. The function returns this vector, then containing the outgoing radiation on the other side of the layer.</p>
<p>The function performs the calculations differently depending on the conditions to improve the speed. There are three cases: <br  />
</p><ol type="1">
<li>Scalar absorption (stokes_dim = 1). <br  />
</li>
<li>The matrix ext_mat_gas is diagonal (unpolarised absorption). <br  />
</li>
<li>The total general case.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stokes_vec</td><td>Input/Output: A Stokes vector. </td></tr>
    <tr><td class="paramname">trans_mat</td><td>Output: Transmission matrix of slab. </td></tr>
    <tr><td class="paramname">ext_mat_av</td><td>Input: Averaged extinction matrix. </td></tr>
    <tr><td class="paramname">abs_vec_av</td><td>Input: Averaged absorption vector. </td></tr>
    <tr><td class="paramname">sca_vec_av</td><td>Input: averaged scattering vector. </td></tr>
    <tr><td class="paramname">lstep</td><td>Input: The length of the RTE step. </td></tr>
    <tr><td class="paramname">rtp_planck_value</td><td>Input: Blackbody radiation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde and Patrick Eriksson, </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-11-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l00108">108</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="rte_8cc_source.html#l00903">ext2trans()</a>, <a class="el" href="lin__alg_8cc_source.html#l00299">id_mat()</a>, <a class="el" href="logic_8cc_source.html#l00377">is_singular()</a>, <a class="el" href="logic_8cc_source.html#l00091">is_size()</a>, <a class="el" href="lin__alg_8cc_source.html#l00142">lubacksub()</a>, <a class="el" href="lin__alg_8cc_source.html#l00054">ludcmp()</a>, <a class="el" href="matpackI_8cc_source.html#l01648">mult()</a>, and <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="doit_8cc_source.html#l01446">cloud_ppath_update1D_planeparallel()</a>, <a class="el" href="doit_8cc_source.html#l01016">cloud_RT_no_background()</a>, and <a class="el" href="m__fos_8cc_source.html#l00058">fos()</a>.</p>

</div>
</div>
<a id="af1255133591972aa0e291e91bdac2340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1255133591972aa0e291e91bdac2340">&#9670;&nbsp;</a></span>za_gridOpt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void za_gridOpt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>za_grid_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>doit_i_field_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>za_grid_fine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor6View.html">ConstTensor6View</a>&#160;</td>
          <td class="paramname"><em>doit_i_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_za_interp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimize the zenith angle grid,</p>
<p>This method optimizes the zenith angle grid. For optimization it uses the interpolation method given by <em>scat_za_interp</em> (0 - linear interpolation, 1 - polynomial interpolation). As input it needs the intensity field calculated on a very fine zenith angle grid (<em>za_grid_fine</em>). The function picks out as many grid points as required to achieve the required accuracy (<em>acc</em> [%]). This methods optimizes only the intensity (first Stokes component) for 1D cases (first latitude and longitude of the intensity field. <br  />
 (Could be modified to optimize all Stokes components at the same time, if we don't want to use the clearsky field for grid optimuzation.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">za_grid_opt</td><td>Optimized zenith angle grid. </td></tr>
    <tr><td class="paramname">doit_i_field_opt</td><td>Optimized intensity field. </td></tr>
    <tr><td class="paramname">za_grid_fine</td><td>Fine zenith angle grid. </td></tr>
    <tr><td class="paramname">doit_i_field</td><td>Radiation field calculated on a very fine za grid. </td></tr>
    <tr><td class="paramname">acc</td><td>Accuracy of optimization [%]. </td></tr>
    <tr><td class="paramname">scat_za_interp</td><td>Interpolation method.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Claudia Emde </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2004-04-05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="doit_8cc_source.html#l01944">1944</a> of file <a class="el" href="doit_8cc_source.html">doit.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l20458">abs</a>, <a class="el" href="sorting_8h_source.html#l00079">get_sorted_indexes()</a>, <a class="el" href="interpolation_8cc_source.html#l00167">gridpos()</a>, <a class="el" href="interpolation_8cc_source.html#l01046">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l02955">interp_poly()</a>, <a class="el" href="interpolation_8cc_source.html#l00802">interpweights()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="array_8h_source.html#l00176">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackI_8cc_source.html#l00180">ConstVectorView::nelem()</a>, <a class="el" href="matpackVI_8cc_source.html#l00050">ConstTensor6View::npages()</a>, <a class="el" href="matpackVI_8cc_source.html#l00032">ConstTensor6View::nvitrines()</a>, <a class="el" href="matpackI_8cc_source.html#l00798">Vector::resize()</a>, and <a class="el" href="matpackI_8cc_source.html#l01580">Matrix::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l02417">doit_za_grid_optCalc()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="doit_8h.html">doit.h</a></li>
    <li class="footer">Generated on Thu Oct 8 2020 12:59:32 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
